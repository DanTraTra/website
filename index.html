<!DOCTYPE html>
<html>
<head>
    <title>Simple Marker with Nearby Places</title>
    <!-- Include the Places library along with the Maps JavaScript API -->
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCAEa800yqko-01Ecfvxm_C22XktXIGifw&callback=initMap&libraries=places&v=beta">
    </script>
    <style>
      /* Set the map height explicitly to define the size of the div element that contains the map. */
      #map {
        height: 100%;
      }

      /* Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
    <script>
      function initMap() {
        const center = { lat: -36.850242614746094, lng: 174.76324462890625 };

        const map = new google.maps.Map(document.getElementById("map"), {
          zoom: 16,
          center: center,
          mapId: "b3f1d0bbd0b2d7b3" // Use your Map ID
        });

        // Use the Places Library to search for nearby places (e.g., restaurants)
        const request = {
          location: center,
          radius: '500', // Search within 500 meters of the center
          type: ['restaurant'], // Search for restaurants
        };

        const service = new google.maps.places.PlacesService(map);
        service.nearbySearch(request, (results, status) => {
          if (status === google.maps.places.PlacesServiceStatus.OK && results) {
            for (let i = 0; i < results.length; i++) {
              createMarker(results[i], map);
            }
          }
        });
      }

      function createMarker(place, map) {

      const svgIcon = `<svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path fill="#000000" stroke="#FFFF00" stroke-width="60" d="M7.62231 19.7812C7.606 19.772 7.58298 19.7589 7.55369 19.7419C7.49512 19.708 7.41142 19.6585 7.30618 19.5937C7.09579 19.4641 6.79879 19.2731 6.44401 19.0225C5.73567 18.5221 4.79055 17.7796 3.84335 16.8098C1.95813 14.8797 0 11.9796 0 8.25C0 3.83172 3.58172 0.25 8 0.25C12.4183 0.25 16 3.83172 16 8.25C16 11.9796 14.0419 14.8797 12.1566 16.8098C11.2095 17.7796 10.2643 18.5221 9.55599 19.0225C9.20121 19.2731 8.90421 19.4641 8.69382 19.5937C8.58858 19.6585 8.50488 19.708 8.44631 19.7419C8.41702 19.7589 8.394 19.772 8.37769 19.7812L8.34991 19.7967C8.13358 19.914 7.8655 19.9149 7.64939 19.7963L7.62231 19.7812ZM8 4C8.17859 4 8.33555 4.11839 8.38461 4.29011L8.81831 5.80808C9.00815 6.4725 9.52751 6.99185 10.1919 7.18169L11.7099 7.61539C11.8816 7.66445 12 7.82141 12 8C12 8.17859 11.8816 8.33555 11.7099 8.38461L10.1919 8.81832C9.5275 9.00815 9.00815 9.52751 8.81831 10.1919L8.38461 11.7099C8.33555 11.8816 8.17859 12 8 12C7.82141 12 7.66445 11.8816 7.61539 11.7099L7.18169 10.1919C6.99185 9.52751 6.47249 9.00815 5.80808 8.81831L4.29011 8.38461C4.11839 8.33555 4 8.17859 4 8C4 7.82141 4.11839 7.66445 4.29011 7.61539L5.80808 7.18169C6.4725 6.99185 6.99185 6.47249 7.18169 5.80808L7.61539 4.29011C7.66445 4.11839 7.82141 4 8 4Z"/></svg>`;

      // URL-encode the SVG
      const encodedSvgIcon = encodeURIComponent(svgIcon);

      // Use the encoded SVG as a Data URL
      const markerIcon = {
          url: `data:image/svg+xml;charset=UTF-8,${encodedSvgIcon}`,
          scaledSize: new google.maps.Size(20, 20), // Scale the icon size as needed
      };

    const marker = new google.maps.Marker({
        map: map,
        position: place.geometry.location,
        icon: markerIcon,
        title: place.name,
    });
    const min = 100;
    const max = 5000;
        google.maps.event.addListener(marker, 'click', () => {
          const infowindow = new google.maps.InfoWindow({
            content: '<div><strong>' + place.name + '</strong><br>' +
              'Daily Sales (past 90 days): ' + Math.floor(Math.random() * (max - min + 1)) + min + '<br>' + '</div>'
          });
          infowindow.open(map, marker);
        });
      }
    </script>
</head>
<body>
    <div id="map"></div> <!-- The map container -->
</body>
</html>
